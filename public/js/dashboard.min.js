/*
 * Keep Memories 
 *
 * Copyright (c) 2016 Spectacklebear
 * Date: Feb-05-2016
 * Author: Margaret Florian (mafloria) 
**/

jQuery(document).ready(function(){
	       
   /**
	* CREATE NEW PERSON FORM  	  
	*/	
	//open/close de form
	$("#link-add-new-person").click(function(){
   		$("#new-person-section").toggle();
	}); 
	// Counts and display the number of chars in the field        
    $("#new-person-nickname").keyup(function(){          
        count_chars($(this), "new-person-nickname-charcounter", 30);//inputfield, div_char_counter, max_chars                      
    });	
	//validates new person form
	 $('#new-person-form').validate({
	 	  submitHandler: function(form, event) { //Send signup data
	 	  	event.preventDefault();	 	  	
		    $.ajax({		    	
	            url: callurl+"webservices/add-buddy/"+validation,
	            type: "POST",
	            data: $("#new-person-form").serialize(),
	            dataType: "json",
	            success: 
	            	function(json_response){	            			            			            			            
	            		switch(json_response.code){
	            			case 201: 
	            				window.location=appurl+"person-memories/"+validation+"/"+json_response.new_buddy_id;
	            			default: alert("error");	            				 	            			
	            		}	                	
	               	}//end function	                    				
			});//end ajax
		  }//end submithandler
	 });//end validate	  		
 
});//end document ready